<!doctype html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>TOTP/HOTP аутентификация</title>
    <meta
      name="description"
      content="Минимальное приложение двухфакторной аутентификации(2FA)."
    />
    <link rel="stylesheet" href="/src/assets/css/index.css" />
  </head>
  <body>
    <header class="container">
      <a href="/" class="logo">
        <h1>T(H)OTP</h1>
      </a>
      <button
        class="back-button hidden"
        onclick="history.length > 2 ? history.back() : location.replace('/')"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M15.75 19.5L8.25 12l7.5-7.5"
          />
        </svg>
        <span>Назад</span>
      </button>
      <div class="grow"></div>
      <div class="shrink-0">
        <account-add-dialog></account-add-dialog>
      </div>
    </header>

    <main class="container">
      <account-list>
        <h2 slot="title">Список аккаунтов</h2>
      </account-list>
    </main>

    <footer class="container">&copy;2023</footer>

    <script type="module" src="/src/main.ts"></script>

    <template id="account-list-template">
      <style>
        section {
          display: -ms-grid;
          display: grid;
          gap: 1.5rem;
        }
        section:not([loading]):empty::after {
          color: rgb(var(--colors-gray));
          content: 'Нет данных';
        }
      </style>
      <slot name="title"></slot>
      <section></section>
    </template>

    <template id="account-item-template">
      <style>
        section {
          display: -ms-grid;
          display: grid;
          gap: 1.5rem;
        }
        section:not([loading]):empty::after {
          color: rgb(var(--colors-gray));
          content: 'Нет данных';
        }
        button {
          font-size: 1rem;
        }
      </style>
      <slot name="title"></slot>
      <section>
        <div>
          <account-code></account-code>
        </div>
        <div>
          <button>Удалить</button>
        </div>
      </section>
    </template>

    <template id="account-code-template">
      <style>
        :host {
          position: relative;
          display: -webkit-box;
          display: -ms-flexbox;
          display: flex;
          -webkit-box-align: center;
          -ms-flex-align: center;
          align-items: center;
        }
        [part='code'] {
          font-size: 1.875rem;
          font-weight: 500;
          letter-spacing: 0.1em;
          display: -webkit-box;
          display: -ms-flexbox;
          display: flex;
          -webkit-box-align: center;
          -ms-flex-align: center;
          align-items: center;
          cursor: pointer;
          padding: 0.75rem 1.25rem;
          border-radius: 0.5rem;
          background-color: rgb(var(--colors-gray-light) / 0.25);
        }
        @media (prefers-color-scheme: dark) {
          :host [part='code'] {
            background-color: rgb(var(--colors-gray-dark) / 0.25);
          }
        }
        :host([card]) [part='code'] {
          font-size: 1.25rem;
          padding: 0;
          border-radius: 0;
          background-color: transparent;
        }
        [part='code'] svg {
          width: 0.8em;
          height: 0.8em;
          color: rgb(var(--colors-gray));
        }
        countdown-timer {
          margin-left: 0.5rem;
        }
        :host([card]) countdown-timer {
          position: absolute;
          top: 0;
          right: 0;
        }
      </style>
      <div part="code" role="button">
        <span></span>
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 01-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 011.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 00-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 01-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5a3.375 3.375 0 00-3.375-3.375H9.75"
          />
        </svg>
      </div>
      <countdown-timer></countdown-timer>
    </template>

    <template id="account-card-template">
      <style>
        :host {
          display: -webkit-box;
          display: -ms-flexbox;
          display: flex;
          -webkit-box-align: center;
          -ms-flex-align: center;
          align-items: center;
          border-radius: 0.5rem;
          padding: 1rem;
          padding-top: 0.75rem;
          padding-right: 0.5rem;
          -webkit-box-shadow:
            0 1px 3px 0 rgb(0 0 0 / 0.1),
            0 1px 2px -1px rgb(0 0 0 / 0.1);
          box-shadow:
            0 1px 3px 0 rgb(0 0 0 / 0.1),
            0 1px 2px -1px rgb(0 0 0 / 0.1);
        }
        :host > div:first-of-type {
          -webkit-box-flex: 1;
          -ms-flex-positive: 1;
          flex-grow: 1;
          display: -webkit-box;
          display: -ms-flexbox;
          display: flex;
          -webkit-box-orient: vertical;
          -webkit-box-direction: normal;
          -ms-flex-direction: column;
          flex-direction: column;
        }
        label {
          font-size: 0.875rem;
          line-height: 1.25rem;
        }
        button {
          -ms-flex-negative: 0;
          flex-shrink: 0;
          background-color: transparent;
          padding: 0.5rem;
          border: 0;
          cursor: pointer;
          color: rgb(var(--colors-text));
        }
        button:hover {
          color: rgb(220 38 38);
        }
        button svg {
          display: block;
          height: 1.5rem;
          width: 1.5rem;
        }
        @media (prefers-color-scheme: dark) {
          :host {
            -webkit-box-shadow: none;
            box-shadow: none;
            background-color: rgb(var(--colors-gray-dark) / 0.25);
          }
        }
      </style>
      <div>
        <div>
          <account-code card></account-code>
        </div>
        <label>
          <slot name="label"></slot>
        </label>
      </div>
      <button aria-label="Удалить">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"
          />
        </svg>
      </button>
    </template>

    <template id="account-add-dialog-template">
      <style>
        button#add-button {
          background-color: transparent;
          padding: 0.5rem;
          border: 0;
          color: rgb(var(--colors-text));
        }
        button#add-button:hover {
          color: rgb(var(--colors-primary-highlight));
        }
        button#add-button svg {
          display: block;
          height: 1.5rem;
          width: 1.5rem;
        }
        #add-dialog {
          min-width: 16rem;
          border-radius: 0.75rem;
          background-color: rgb(var(--colors-bg));
          -webkit-box-shadow:
            0 10px 15px -3px rgb(0 0 0 / 0.1),
            0 4px 6px -4px rgb(0 0 0 / 0.1);
          box-shadow:
            0 10px 15px -3px rgb(0 0 0 / 0.1),
            0 4px 6px -4px rgb(0 0 0 / 0.1);
          padding: 1.5rem;
          border-color: transparent;
        }
        #add-dialog::-webkit-backdrop {
          background-color: rgb(255 255 255 / 0.75);
          -webkit-backdrop-filter: blur(8px);
          backdrop-filter: blur(8px);
        }
        #add-dialog::backdrop {
          background-color: rgb(255 255 255 / 0.75);
          -webkit-backdrop-filter: blur(8px);
          backdrop-filter: blur(8px);
        }
        @media (min-width: 640px) {
          #add-dialog {
            min-width: 20rem;
          }
        }
        @media (prefers-color-scheme: dark) {
          #add-dialog::-webkit-backdrop {
            background-color: rgb(0 0 0 / 0.75);
          }
          #add-dialog::backdrop {
            background-color: rgb(0 0 0 / 0.75);
          }
        }
        h3#add-dialog-label {
          font-size: 1.25rem;
          line-height: 1.75rem;
          font-weight: 600;
          margin: 0;
          color: rgb(var(--colors-text));
        }
        form#add-form {
          display: -webkit-box;
          display: -ms-flexbox;
          display: flex;
          -webkit-box-orient: vertical;
          -webkit-box-direction: normal;
          -ms-flex-direction: column;
          flex-direction: column;
        }
        form#add-form > :not([hidden]) ~ :not([hidden]) {
          margin-top: 1.25rem;
        }
        button#add-form-cancel {
          color: rgb(var(--colors-text));
        }
        button#add-form-submit {
          margin-left: 0.5rem;
          color: rgb(var(--colors-primary));
        }
        button,
        input {
          font-size: 1rem;
        }
        button {
          cursor: pointer;
        }
      </style>
      <button id="add-button" aria-haspopup="true" aria-label="Добавить">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          fill="none"
          viewBox="0 0 24 24"
          stroke-width="1.5"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M12 4.5v15m7.5-7.5h-15"
          />
        </svg>
      </button>

      <dialog
        id="add-dialog"
        role="dialog"
        aria-modal="true"
        aria-labelledby="add-dialog-label"
      >
        <form id="add-form">
          <h3 id="add-dialog-label">Добавить аккаунт</h3>
          <input
            id="add-form-label"
            type="text"
            name="add-form-label"
            placeholder="Введите label"
            aria-label="label input"
            autocomplete="off"
            required
            autofocus
          />
          <input
            id="add-form-secret"
            type="text"
            name="add-form-secret"
            placeholder="Введите secret"
            aria-label="secret input"
            autocomplete="off"
            required
          />
          <div>
            <button
              id="add-form-cancel"
              type="button"
              value="cancel"
              formmethod="dialog"
            >
              Отмена
            </button>
            <button id="add-form-submit" value="submit" formmethod="dialog">
              Добавить
            </button>
          </div>
        </form>
      </dialog>
    </template>

    <template id="countdown-timer-template">
      <style>
        :host {
          width: 3rem;
          height: 3rem;
          position: relative;
        }
        :host > div:first-of-type {
          color: rgb(var(--colors-gray-light) / 0.5);
          -webkit-transition: color 150ms cubic-bezier(0.4, 0, 0.2, 1);
          -o-transition: color 150ms cubic-bezier(0.4, 0, 0.2, 1);
          transition: color 150ms cubic-bezier(0.4, 0, 0.2, 1);
        }
        @media (prefers-color-scheme: dark) {
          :host > div:first-of-type {
            color: rgb(var(--colors-gray-dark) / 0.5);
          }
        }
        [part='svg'] {
          -webkit-transform: rotate(-90deg);
          -ms-transform: rotate(-90deg);
          transform: rotate(-90deg);
          width: 100%;
          height: 100%;
          display: block;
        }
        [part='value'] {
          color: currentColor;
          font-size: 1rem;
          font-weight: 700;
          position: absolute;
          left: 50%;
          top: 50%;
          -webkit-transform: translate(-50%, -50%);
          -ms-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
        }
      </style>
      <div>
        <svg
          part="svg"
          xmlns="http://www.w3.org/2000/svg"
          width="48"
          height="48"
          viewBox="0 0 48 48"
        >
          <circle
            r="20"
            cx="24"
            cy="24"
            fill="none"
            stroke="currentColor"
            stroke-width="2px"
          ></circle>
        </svg>
        <span part="value"></span>
      </div>
    </template>
  </body>
</html>
